- handle case of `NUM_PROC > M`
- 